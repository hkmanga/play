(this["webpackJsonphkmanga-play"]=this["webpackJsonphkmanga-play"]||[]).push([[0],{101:function(e,t,n){"use strict";var a=n(9),c=(n(0),n(2));t.a=function(e){return Object(c.jsx)("div",Object(a.a)({tabIndex:0,style:{outline:"none",cursor:"pointer"}},e))}},111:function(e,t,n){"use strict";var a=n(9),c=(n(0),n(223)),r=n(4),o=n(2);t.a=function(e){return Object(o.jsx)(c.a,Object(a.a)(Object(a.a)({size:"small",style:{backgroundColor:Object(r.i)(.2)}},e),{},{children:e.children}))}},112:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(15),c=n(25),r=n(24),o=n(18),_=n(63),i=n(20),s=(["widthFit","heightFit"].concat(Object(o.a)(_.b)),function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return n}(i.c))},113:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(18),n(8);var a=n(4),c=n(78),r=function(e,t){var n=e.trim();return t?Object(c.a)(n,JSON.stringify(t).replace(a.g,"$1").replace(a.f,"0")):JSON.parse(Object(c.a)(n)||"{}")}},146:function(e,t,n){"use strict";var a=n(9),c=n(8),r=n(0),o=n(120),_=n(119),i=n(160),s=n(35),u=n(70),l=n(4),b=n(54),d=n(27),O=n(2);t.a=function(e){var t=e.scenePhoto,n=e.onReady,j=Object(o.a)(),p=Object(r.useCallback)((function(){h.forEach((function(e){clearInterval(e)})),h=[]}),[]);Object(_.a)((function(){p(),f.forEach((function(e){clearTimeout(e)})),f=[]}));var E=t.props,g=E.effects,m=E.afterEffects;Object(l.a)("ScenePhoto: ",j);var P=Object(r.useState)(!1),x=Object(c.a)(P,2),y=x[0],v=x[1],M=Object(i.a)(),D=Object(c.a)(M,2),C=D[0],S=D[1],T=Object(b.c)(),I=Object(c.a)(T,1)[0];Object(r.useEffect)((function(){I&&S(Object(a.a)(Object(a.a)({},E),{},{url:I.get(Object(d.e)(E.code||E.url))}))}),[S,E,I]);var B=C.onClick,k=C.url,A=C.opacity,R=C.zIndex,L=C.top,w=C.left,U=C.bottom,W=C.right,K=C.filter,F=C.transform,z=C.timingFunction,N=C.repeatEffects,q=C.duration,H=void 0===q?0:q,V=Object(r.useState)(!1),$=Object(c.a)(V,2),G=$[0],J=$[1],X=Object(r.useCallback)((function(e){var t=0,n=0,c=0;e.forEach((function(e){var r=Object(l.h)(e);Object(l.a)(r),c+=(r.delay||0)+t+n,f.push(setTimeout((function(){I&&S(Object(a.a)(Object(a.a)({},r),{},{url:I.get(Object(d.e)(r.url))}))}),1e3*c)),t=r.delay||0,n=r.duration||0}))}),[S,I]);Object(r.useEffect)((function(){if(y&&g&&(X(g),p(),J(!1),N)){var e=g.map((function(e){return(e.duration||0)+(e.delay||0)})).concat([0]).reduce((function(e,t){return e+t}));console.warn(e),h.push(setInterval((function(){return!!g&&X(g)}),1e3*e))}}),[J,p,X,N,g,y]);var Y={visibility:"hidden"},Z="",Q="0s",ee="ease-in-out";H&&(Z="all",Q=H+"s"),z&&(ee=z),y&&(Y={display:"block",opacity:Object(l.d)(A)?+A:void 0,filter:K,transform:F},["width","height","top","right","bottom","left"].forEach((function(e){var t=C[e];Object(l.d)(t)&&(t=Object(l.b)(Object(d.e)(t),l.e,(function(e){return e+"px"}))),Y[e]=t})),Y.transitionProperty=Z,Y.transitionDuration=Q,Y.transitionTimingFunction=ee);var te={};return G||(te.onClick=function(){B&&B(),m&&(p(),X(m),J(!0))}),Object(l.d)(k)&&(te.src=k),Object(O.jsx)(s.a,{zIndex:R,position:"absolute",top:L,right:W,bottom:U,left:w,style:{transitionProperty:Z,transitionDuration:Q,transitionTimingFunction:ee},children:Object(O.jsx)(u.a,Object(a.a)({style:Y,onReady:function(){v(!0),n&&n()}},te))})};var f=[],h=[]},147:function(e,t,n){"use strict";var a=n(9),c=n(8),r=n(0),o=n(70),_=n(160),i=n(120),s=n(119),u=n(4),l=n(17),b=n(54),d=n(2),O=Object(r.forwardRef)((function(e,t){var n=e.onReady,O=e.absolute,p=void 0!==O&&O,E=e.sceneBgPhoto,g=e.nextSceneId,m=void 0===g?"":g,P=E.props,x=P.effects,y=P.afterEffects;j=y||[];var v=Object(r.useState)(!1),M=Object(c.a)(v,2),D=M[0],C=M[1],S=Object(_.a)(P),T=Object(c.a)(S,2),I=T[0],B=T[1],k=Object(b.c)(),A=Object(c.a)(k,1)[0];Object(r.useEffect)((function(){A&&B(Object(a.a)(Object(a.a)({},P),{},{url:A.get(P.url||"")}))}),[B,P,A]),Object(r.useEffect)((function(){if(m&&j.length){var e=Object(u.h)(j[0]);f.push(setTimeout((function(){B(e),Object(u.a)(e)}),1e3*(e.delay||0))),j.splice(0,1)}}),[m,B]);var R=I.repeatEffects,L=I.url,w=I.filter,U=I.duration,W=void 0===U?1:U,K=I.transform,F=I.timingFunction,z=I.width,N=I.height,q=I.widthFit,H=I.heightFit,V=I.zIndex,$=void 0===V?-1:V,G=I.opacity,J=I.top,X=I.left,Y=I.bottom,Z=I.right;z=q?"100%":z,N=H?"100%":N;var Q=Object(i.a)();Object(u.a)("Scene BG Photo: ",Q);var ee=Object(r.useCallback)((function(){h.forEach((function(e){clearInterval(e)})),h=[]}),[]);Object(s.a)((function(){ee(),f.forEach((function(e){clearTimeout(e)})),f=[]}));var te=Object(r.useCallback)((function(e){var t=Object(u.h)(e);Object(u.a)(t),f.push(setTimeout((function(){B(t)}),1e3*+(t.delay||0)))}),[B]),ne=Object(r.useCallback)((function(e){e.forEach((function(e){te(e)}))}),[te]);Object(r.useEffect)((function(){D&&x&&(ne(x),ee(),R&&h.push(setInterval((function(){return!!x&&ne(x)}),1e3*x.map((function(e){return(e.duration||0)+(e.delay||0)})).concat([0]).reduce((function(e,t){return e+t})))))}),[ee,ne,R,x,D]);var ae={top:J,left:X,bottom:Y,right:Z,opacity:0,transform:K,filter:w};!function(){if(D){ae={opacity:Object(u.b)(G,(function(e){return!Object(u.d)(e)}),(function(){return 1}))},["top","right","bottom","left"].forEach((function(e){var t=I[e];t=Object(u.d)(t)?Object(u.b)(t,u.e,(function(e){return e+"px"})):void 0,ae[e]=t}));var e="",t="ease-in-out";W&&(e="all ".concat(W,"s")),F&&(t=F),ae.transition=e+" "+t}}();var ce=Object(d.jsx)(l.a,{absolute:!0,width:z,height:N,style:ae,children:Object(d.jsx)(o.a,{src:L,onReady:function(){D||(f.push(setTimeout((function(){C(!0)}),100)),n&&n())},style:{width:z,height:N,display:"block",alignSelf:"center"}})});return Object(d.jsxs)("div",{style:{top:0,right:0,bottom:0,left:0,zIndex:$,position:p?"absolute":"fixed"},ref:t,children:[e.children,L&&ce]})}));t.a=O;var f=[],h=[],j=[]},148:function(e,t,n){"use strict";var a=n(0),c=n(17),r=n(57),o=n(35),_=n(80),i=n(47),s=n(228),u=n(162),l=n(163),b=n(225),d=n(27),O=n(224),f=n(4),h=n(45),j=n(105),p=n(101),E=n(2);t.a=function(e){var t=e.storyState,n=e.handleChoiceClick,g=e.disableChoice,m=e.sceneText,P=e.onInputChange,x=e.choiceList,y=m.props,v=y.value,M=y.textBg,D=y.delay,C=void 0===D?0:D,S=y.duration,T=void 0===S?1:S,I=y.textAlign,B=void 0===I?"center":I,k=y.width,A=void 0===k?"auto":k,R=y.height,L=void 0===R?"auto":R,w=y.top,U=void 0===w?"auto":w,W=y.right,K=void 0===W?"auto":W,F=y.bottom,z=void 0===F?"auto":F,N=y.left,q=void 0===N?"auto":N,H=y.colour,V=y.size,$=y.fontFamily,G=y.enableInput,J=y.inputKey,X=Object(j.a)().t,Y=1e3*C,Z=Y+1e3*T,Q=Object(a.useCallback)((function(e,t){return Object(E.jsxs)(_.a,{display:"flex",position:"relative",overflow:"hidden",justifyContent:"left"===B?"flex-start":"right"===B?"flex-end":"center",maxWidth:340,width:Object(f.b)(A,f.e,(function(e){return e+"px"})),height:Object(f.b)(L,f.e,(function(e){return e+"px"})),style:{overflowWrap:"anywhere"},borderRadius:4,my:.4,px:2,children:[Object(E.jsx)(c.a,{absolute:!0,top:0,bgcolor:M,style:{opacity:.4}}),Object(E.jsx)(i.a,{style:function(){var e={zIndex:1};return e.textShadow=d.b,Object(f.d)(H)&&(e.color=H),Object(f.d)(V)&&(e.fontSize=+V),Object(f.d)($)&&(e.fontFamily=$),e}(),children:e})]},"text-".concat(t))}),[$,V,L,M,H,A,B]);return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(c.a,{absolute:!0,top:Object(f.b)(U,f.e,(function(e){return e+"px"})),right:Object(f.b)(K,f.e,(function(e){return e+"px"})),bottom:Object(f.b)(z,f.e,(function(e){return e+"px"})),left:Object(f.b)(q,f.e,(function(e){return e+"px"})),children:Object(E.jsxs)(r.a,{box:{flexDirection:"column"},duration:T,delay:Y,children:[v&&Object(d.e)(v).split("\n").map(Q),G&&Object(E.jsx)(s.a,{inputProps:{style:{textAlign:"center"}},variant:"filled",autoFocus:!0,onChange:P})]})}),Object(E.jsx)(c.a,{absolute:!0,zIndex:100,bottom:10,children:Object(E.jsxs)(E.Fragment,{children:[1===x.length&&(!G||J&&Object(f.d)(t[J]))&&(!g||"[force display]"===x[0].text)&&Object(E.jsx)(r.a,{duration:1,delay:Z,children:Object(E.jsx)(p.a,{className:"animate__animated animate__flash animate__slower animate__infinite animate__delay-2s",onClick:function(){n(x[0])},children:Object(E.jsxs)(o.a,{flexDirection:"column",children:[Object(E.jsx)(O.a,{fontSize:"large",style:{fill:"#fff",stroke:"#000",strokeWidth:1}}),Object(E.jsx)(i.a,{variant:"overline",children:X("tap here to continue")})]})})}),x.length>1&&!g&&Object(E.jsx)(r.a,{box:{p:1,width:"100%"},duration:1,delay:Z,children:Object(E.jsx)(u.a,{spacing:1,container:!0,children:x.map((function(e,t){return Object(E.jsx)(u.a,{item:!0,xs:t===x.length-1&&t%2===0?12:6,children:Object(E.jsxs)(_.a,{borderRadius:8,position:"relative",overflow:"hidden",children:[Object(E.jsx)(c.a,{absolute:!0,top:0,zIndex:-1,bgcolor:"#fee",style:{opacity:.8}}),Object(E.jsx)(l.a,{button:!0,onClick:function(){e.toExternalLink&&e.externalLink?Object(h.b)(Object(d.e)(e.externalLink)):n(e)},children:Object(E.jsx)(b.a,{primaryTypographyProps:{variant:"subtitle2",align:"center",style:{color:"black"}},primary:Object(d.e)(e.text||"")})})]})},"choice-".concat(t))}))})})]})})]})}},149:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(15),c=n(25),r=n(24),o=n(18),_=n(20),i=(["value","textAlign","size","colour","textBg","fontFamily","enableInput","inputKey"].concat(Object(o.a)(_.d),Object(o.a)(_.b),Object(o.a)(_.e)),function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return n}(_.c))},150:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(15),c=n(25),r=n(24),o=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return n}(n(20).c)},17:function(e,t,n){"use strict";var a=n(9),c=n(102),r=(n(0),n(35)),o=n(2);t.a=function(e){var t=e.absolute,n=Object(c.a)(e,["absolute"]);return Object(o.jsx)(r.a,Object(a.a)({flexDirection:"column",bottom:0,right:0,left:0,position:t?"absolute":"fixed"},n))}},175:function(e,t,n){},183:function(e,t,n){"use strict";n.r(t);var a="\u7db2\u5740\u9023\u7d50",c="\u5834\u666f",r="\u6587\u5b57",o="\u9802\u90e8\u8ddd\u96e2",_="\u53f3\u908a\u8ddd\u96e2",i="\u5de6\u908a\u8ddd\u96e2",s="\u5e95\u90e8\u8ddd\u96e2",u="\u9ad8\u5ea6",l="\u95ca\u5ea6",b="\u6548\u679c\u6642\u9593",d="\u5ef6\u9072",O="\u80cc\u666f\u5716\u7247",f={"basic information":"\u57fa\u672c\u8cc7\u6599","years old or above":"\u6b72\u6216\u4ee5\u4e0a","this story is suitable for":"\u9019\u500b\u6545\u4e8b\u9069\u5408\u65bc...","what should be the title?":"\u6a19\u984c\u662f\u751a\u9ebc\uff1f","what is the ID of this story?":"\u9019\u500b\u6545\u4e8b\u7684 ID \u662f\u751a\u9ebc\uff1f","what is the major language this story will be written in?":"\u7528\u751a\u9ebc\u8a9e\u8a00\u4f86\u5beb\u7684\uff1f","choose a unique ID to identify this story.":"\u9078\u64c7\u4e00\u500b\u7368\u6709\u7684 ID \u4f86\u8b58\u5225\u9019\u500b\u6545\u4e8b","create-new-story":"\u6309\u52a0\u865f\u958b\u59cb\u88fd\u4f5c","skip after seconds":"\u65bc\u79d2\u6578\u5f8c\u8df3\u904e","this is a start scene":"\u9019\u662f\u8d77\u59cb\u5834\u666f","add new condition":"\u65b0\u589e\u689d\u4ef6","add new choice":"\u65b0\u589e\u9078\u9805","add scene":"\u65b0\u589e\u5834\u666f","add evaluate":"\u65b0\u589e\u904e\u6ffe\u5668","add update":"\u65b0\u589e\u4fee\u6539\u5668","confirm-leave-editing":"\u96e2\u958b\u7de8\u8f2f\u55ce\uff1f","effect-key":"\u6548\u679c\u540d\u7a31","effect-adjust":"\u8abf\u7bc0\u6578\u503c","effect-assign":"\u8a2d\u5b9a\u6578\u503c","effect-textValue":r,untitled:"\u672a\u547d\u540d",default:"\u9810\u8a2d",else:"\u5426\u5247",vMin:"\u6700\u5c0f\u503c",vMax:"\u6700\u5927\u503c",vText:r,textValue:r,remove:"\u79fb\u9664",unlinked:"\u672a\u9023\u63a5",linked:"\u5df2\u9023\u63a5",tag:"\u6a19\u7c64",seconds:"\u79d2",edited:"\u5df2\u7de8\u8f2f",everyone:"\u6240\u6709\u4eba",rating:"\u5206\u7d1a",name:"\u540d\u7a31",email:"\u96fb\u90f5",website:"\u7db2\u7ad9",githubUserName:"GitHub \u7528\u6236\u540d\u7a31",creationTime:"\u88fd\u4f5c\u6642\u9593",lastEditTime:"\u66f4\u65b0\u6642\u9593",scenes:"\u5834\u666f",scene:c,id:"ID",title:"\u6a19\u984c",language:"\u8a9e\u8a00",cover:"\u5c01\u9762",position:"\u4f4d\u7f6e",zoom:"\u7126\u8ddd",mediaUrlRoot:"\u591a\u5a92\u9ad4\u7db2\u5740\u6839\u90e8",homePageUrl:"\u7db2\u7ad9\u4e3b\u9801\u7db2\u5740\u9023\u7d50",copyright:"\u7248\u6b0a",license:"\u6191\u7167",termsAndConditionsUrl:"\u4f7f\u7528\u689d\u6b3e\u7db2\u5740\u9023\u7d50",startScene:"\u958b\u59cb\u5834\u666f",author:"\u4f5c\u8005",pegiRating:"PEGI \u5206\u7d1a",description:"\u63cf\u8ff0",top:"\u9802\u90e8",right:"\u53f3\u908a",bottom:"\u5e95\u90e8",left:"\u5de6\u908a",effect:"\u6548\u679c",conditionKey:"\u689d\u4ef6\u540d\u7a31",conditions:"\u689d\u4ef6",condition:"\u689d\u4ef6",choices:"\u9078\u9805",choice:"\u9078\u9805",text:r,fontFamily:"\u5b57\u578b",fontSize:"\u5927\u5c0f",textDelay:d,textDuration:b,textColour:"\u984f\u8272",textBg:"\u80cc\u666f\u984f\u8272",textWidth:l,textHeight:u,textTop:o,textBottom:s,textLeft:i,textRight:_,bgm:"BGM",stopBgm:"\u505c\u6b62BGM",audio:"\u8072\u97f3",audioDelay:d,clearBgPhoto:"\u6e05\u9664\u80cc\u666f\u5716\u7247",bgPhoto:O,bgWidth:l,bgHeight:u,bgDelay:d,bgDuration:b,bgColour:"\u80cc\u666f\u984f\u8272",clearPhoto:"\u6e05\u9664",stackPhoto:"\u758a\u52a0",photoUrl:a,photoPersist:"\u6301\u7e8c",photoZIndex:"Z \u8ef8\u6578\u503c",photoEnterFrom:"\u9032\u5165\u65b9\u5411",photoDelay:d,photoDuration:b,photoWidth:l,photoHeight:u,photoTop:o,photoBottom:s,photoLeft:i,photoRight:_,url:a,Welcome:"\u6b61\u8fce",stories:"\u6545\u4e8b",start:"\u958b\u59cb"};t.default=f},184:function(e,t,n){"use strict";n.r(t);t.default={}},20:function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return b}));var a=n(15),c=n(25),r=n(24),o=n(85),_="[default-condition]",i=["audio","photoEffect","bgPhoto","photo"],s=([].concat(i,["text","node","evaluate","update","regulate"]),["key"].concat(["adjust","assign","textValue"]),["width","height"]),u=["delay","duration"],l=["top","bottom","left","right"],b=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return n}(o.a)},220:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(13),o=n.n(r),_=(n(175),n(8)),i=(n(176),n(177),n(179),n(180),n(181),n(182),n(118)),s=n(138),u=n(79),l={en:{text:"English"},"zh-TW":{text:"\u4e2d\u6587"}};i.a.use(s.a).use(u.e).init({resources:{zh:{translations:n(183).default},en:{translations:n(184).default}},fallbackLng:"en",ns:["translations"],defaultNS:"translations",keySeparator:!1,interpolation:{escapeValue:!1}});i.a;var b=n(15),d=n(68),O=n(25),f=n(24),h=function(e){Object(O.a)(n,e);var t=Object(f.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"name",get:function(){return this.props.name}},{key:"render",value:function(){var e=this.props,t=e.name,n=e.styles,a=void 0===n?[]:n,c=e.subsets,r=void 0===c?[]:c,o=[t];return a.length&&o.push(a.join(",")),r.length&&o.push(r.join(",")),o.join(":")}}]),n}(n(85).a),j={vidaloka:new h({name:"Vidaloka"}),atma:new h({name:"Atma",styles:[400],subsets:["latin-ext"]}),roboto:new h({name:"Roboto",styles:[400],subsets:["latin-ext"]}),nanumPenScript:new h({name:"Nanum Pen Script",styles:[400],example:"\uadf8\ub4e4\uc758 \uc7a5\ube44\uc640 \uae30\uad6c\ub294 \ubaa8\ub450 \uc0b4\uc544 \uc788\ub2e4."}),sunFlower:new h({name:"Sunflower",styles:[300],example:"\uadf8\ub4e4\uc758 \uc7a5\ube44\uc640 \uae30\uad6c\ub294 \ubaa8\ub450 \uc0b4\uc544 \uc788\ub2e4."}),songMyung:new h({name:"Song Myung",example:"\uadf8\ub4e4\uc758 \uc7a5\ube44\uc640 \uae30\uad6c\ub294 \ubaa8\ub450 \uc0b4\uc544 \uc788\ub2e4."}),hiMelody:new h({name:"Hi Melody",example:"\ud30c\ub3c4\uac00 \ud478\ub974\ub978 \uc800\ub141\uc5d0 \ub0b4\ub358\uc838\uc838 \ubd80\uc11c\uc84c\ub2e4!"}),nanumGothic:new h({name:"Nanum Gothic",styles:[400],subsets:["korean"],example:"\ub3cc\uc544\uac00\ub294 \uae38\uc740 \uc678\ub85c\uc6b4 \uc5ec\ud589\uc774 \ub420 \ub4ef \ud588\ub2e4."}),davidLibre:new h({name:"David Libre",styles:[400],example:".\u05d0\u05d6 \u05d4\u05d2\u05d9\u05e2 \u05d4\u05dc\u05d9\u05dc\u05d4 \u05e9\u05dc \u05db\u05d5\u05db\u05d1 \u05d4\u05e9\u05d1\u05d9\u05d8 \u05d4\u05e8\u05d0\u05e9\u05d5\u05df"}),bellefair:new h({name:"Bellefair",styles:[400],example:".\u05d0\u05d6 \u05d4\u05d2\u05d9\u05e2 \u05d4\u05dc\u05d9\u05dc\u05d4 \u05e9\u05dc \u05db\u05d5\u05db\u05d1 \u05d4\u05e9\u05d1\u05d9\u05d8 \u05d4\u05e8\u05d0\u05e9\u05d5\u05df"}),frankRuhlLibre:new h({name:"Frank Ruhl Libre",styles:[400],example:".\u05d0\u05d6 \u05d4\u05d2\u05d9\u05e2 \u05d4\u05dc\u05d9\u05dc\u05d4 \u05e9\u05dc \u05db\u05d5\u05db\u05d1 \u05d4\u05e9\u05d1\u05d9\u05d8 \u05d4\u05e8\u05d0\u05e9\u05d5\u05df"}),sansJp:new h({name:"Noto Sans JP",styles:[400],subsets:["japanese"],example:"\u76ee\u524d\u306e\u5149\u666f\u306f\u5b9f\u306b\u58ee\u5927\u306a\u3082\u306e\u3060\u3063\u305f\u3002"}),serifJp:new h({name:"Noto Serif JP",styles:[400],subsets:["japanese"],example:"\u79c1\u306e 2 \u3064\u306e\u4eba\u683c\u306b\u306f\u5171\u901a\u306e\u8a18\u61b6\u304c\u3042\u308b\u3002"}),sansSc:new h({name:"Noto Sans SC",styles:[400],subsets:["chinese-simplified"],example:"\u6211\u770b\u7740\u66b4\u98ce\u96e8\uff0c\u7f8e\u4e0d\u80dc\u6536\u5374\u4e5f\u60ca\u5fc3\u52a8\u9b44\u3002"}),longCang:new h({name:"Long Cang",example:"\u6708\u4eae\u7684\u8138\u63a9\u6620\u5728\u9634\u5f71\u4e2d\u3002"}),sansTc:new h({name:"Noto Sans TC",styles:[400],subsets:["chinese-traditional"],example:"\u7d05\u8272\u706b\u5149\u6620\u51fa\u92f8\u9f52\u5f62\u6a5f\u7ffc\u7684\u8f2a\u5ed3\u3002"})},p=Object.keys(j).map((function(e){return e})),E=n(141),g=n.n(E),m=p.map((function(e){return j[e].render()}));g.a.load({google:{families:m},loading:function(){},active:function(){}}),Array.prototype.att=function(e){return this.map((function(t){return t.att(e)}))},String.prototype.att=function(e){var t=this,n=function(e){t=t.replace(/\{\}/,e)};return Array.isArray(e)?e.forEach(n):n(e),t};var P=n(4),x=n(83),y=n(14),v=n(105),M=n(303),D=n(120),C=n(160),S=n(301),T=n(302),I=n(9),B=n(155),k=function(){function e(t){Object(b.a)(this,e),this.defaultFontFamily='"Roboto", "Helvetica", "Arial", sans-serif',this.options={props:{MuiBackdrop:{}},typography:{fontFamily:this.defaultFontFamily,htmlFontSize:16,fontSize:14,fontWeightLight:300,fontWeightRegular:400,fontWeightMedium:500,fontWeightBold:700,h1:{fontFamily:this.defaultFontFamily,fontWeight:300,fontSize:"6rem",lineHeight:1,letterSpacing:"-0.01562em"},h2:{fontFamily:this.defaultFontFamily,fontWeight:300,fontSize:"3.75rem",lineHeight:1,letterSpacing:"-0.00833em"},h3:{fontFamily:this.defaultFontFamily,fontWeight:400,fontSize:"3rem",lineHeight:1.04,letterSpacing:"0em"},h4:{fontFamily:this.defaultFontFamily,fontWeight:400,fontSize:"2.125rem",lineHeight:1.17,letterSpacing:"0.00735em"},h5:{fontFamily:this.defaultFontFamily,fontWeight:400,fontSize:"1.5rem",lineHeight:1.33,letterSpacing:"0em"},h6:{fontFamily:this.defaultFontFamily,fontWeight:500,fontSize:"1.25rem",lineHeight:1.6,letterSpacing:"0.0075em"},subtitle1:{fontFamily:this.defaultFontFamily,fontWeight:400,fontSize:"1rem",lineHeight:1.75,letterSpacing:"0.00938em"},subtitle2:{fontFamily:this.defaultFontFamily,fontWeight:500,fontSize:"0.875rem",lineHeight:1.57,letterSpacing:"0.00714em"},body1:{fontFamily:this.defaultFontFamily,fontWeight:400,fontSize:"1rem",lineHeight:1.5,letterSpacing:"0.00938em"},body2:{fontFamily:this.defaultFontFamily,fontWeight:400,fontSize:"0.875rem",lineHeight:1.43,letterSpacing:"0.01071em"},button:{fontFamily:this.defaultFontFamily,fontWeight:500,fontSize:"0.875rem",lineHeight:1.75,letterSpacing:"0.02857em",textTransform:"uppercase"},caption:{fontFamily:this.defaultFontFamily,fontWeight:400,fontSize:"0.75rem",lineHeight:1.66,letterSpacing:"0.03333em"},overline:{fontFamily:this.defaultFontFamily,fontWeight:400,fontSize:"0.75rem",lineHeight:2.66,letterSpacing:"0.08333em",textTransform:"uppercase"},allVariants:{textDecoration:"none"}},palette:{common:{black:"#000",white:"#fff"},type:"light",primary:{light:"#7986cb",main:"#3f51b5",dark:"#303f9f",contrastText:"#fff"},secondary:{light:"#ff4081",main:"#f50057",dark:"#c51162",contrastText:"#fff"},error:{light:"#e57373",main:"#f44336",dark:"#d32f2f",contrastText:"#fff"},text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",hint:"rgba(0, 0, 0, 0.38)"},background:{paper:"#fff",default:"#fafafa"},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.08)",hoverOpacity:.08,selected:"rgba(0, 0, 0, 0.14)",disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)"}},overrides:{MuiAppBar:{},MuiInput:{},MuiCard:{},MuiLink:{},MuiButton:{},MuiIconButton:{},MuiContainer:{},MuiListItem:{},MuiListItemText:{},MuiListItemIcon:{},MuiSvgIcon:{},MuiIcon:{}}},this.options=t||this.options}return Object(d.a)(e,[{key:"theme",get:function(){return Object(B.a)(this.options)}}]),e}(),A=n(103),R=function(e){Object(O.a)(n,e);var t=Object(f.a)(n);function n(){var e;return Object(b.a)(this,n),(e=t.call(this)).options.overrides=Object(I.a)(Object(I.a)({},e.options.overrides),{},{MuiAppBar:{root:{"& *":{color:A.a[600]}},colorPrimary:{backgroundColor:"transparent"}}}),e}return n}(k),L=n(104),w=function(e){Object(O.a)(n,e);var t=Object(f.a)(n);function n(){var e;return Object(b.a)(this,n),(e=t.call(this)).options.typography=Object(I.a)(Object(I.a)({},e.options.typography),{},{allVariants:{color:A.a[100]}}),e.options.palette=Object(I.a)(Object(I.a)({},e.options.palette),{},{type:"dark",primary:{light:"#fa0",main:"#f94",dark:"#f82",contrastText:"#fff"},secondary:{light:"#ff4081",main:"#f50057",dark:"#c51162",contrastText:"#fff"},text:{primary:A.a[100],secondary:A.a[500],disabled:A.a[700]},background:{default:A.a[900],paper:A.a[800]}}),e.options.overrides=Object(I.a)(Object(I.a)({},e.options.overrides),{},{MuiAppBar:{root:{"& *":{color:A.a[200]}},colorPrimary:{backgroundColor:Object(P.i)()}},MuiCard:{root:{backgroundColor:A.a[800]}},MuiFab:{},MuiSvgIcon:{root:{fill:A.a[200],display:"block"},colorError:{fill:L.a[200]}},MuiIconButton:{root:{"&.Mui-disabled *":{fill:A.a[700],color:A.a[700]}}},MuiDivider:{root:{backgroundColor:A.a[700]}},MuiInput:{underline:{"&::before":{borderBottomColor:A.a[400]}}}}),e}return n}(k),U=n(80),W=n(47),K=n(35),F=n(2),z=function(){return Object(F.jsxs)(K.a,{flexDirection:"column",height:"100vh",children:[Object(F.jsx)(U.a,{height:20}),Object(F.jsx)(W.a,{color:"primary",align:"center",variant:"h2",children:"HK ManGa"})]})},N=function(e){var t=Object(v.a)().t;return Object(F.jsx)(K.a,{height:"100vh",children:Object(F.jsx)(W.a,{align:"center",variant:"h5",color:"textSecondary",children:t("Not Found")+" :3"})})},q=n(77),H=n.n(q),V=n(96),$=n(52),G=n(282),J=n(20),X=n(57),Y=n(283),Z=n(281),Q=n(164),ee=n(17),te=n(27),ne=function(e){var t=e.dimensions,n=e.children,a=Object(F.jsx)("div",{style:{position:"fixed",top:0,right:0,bottom:0,left:0},children:n});if(!t)return a;var c={};t&&Object.keys(t).forEach((function(e){var n=t[e]||"";c[e]=Object(P.b)(n,P.e,(function(e){return e+"px"}))}));var r=c.width,o=c.height;return Object(P.d)(r)||Object(P.d)(o)?Object(F.jsx)("div",{style:{width:r,height:o,maxWidth:"100vw",maxHeight:"-webkit-fill-available",margin:"auto",overflow:"hidden",position:"relative"},children:n}):a},ae=n(54),ce=n(269),re=n(270),oe=n(271),_e=n(272),ie=n(273),se=n(274),ue=n(275),le=n(276),be=n(277),de=n(278),Oe=n(279),fe=n(280),he=n(223),je=n(267),pe=n(268),Ee=n(266),ge=function(e){var t=Object(Ee.a)(!1),n=Object(_.a)(t,2),a=n[0],c=n[1],r=e.title,o=e.description;return Object(F.jsxs)(ee.a,{style:{transition:"all .6s ease-in-out"},justifyContent:"flex-end",alignItems:"center",overflow:"hidden",height:a?360:50,zIndex:1,left:0,right:"auto",m:2,children:[["fb","rd","tg","ws","tt"].map((function(e,t){var n=me[e].Btn,a=me[e].Icon,c={};return["rd","tg","ws","tt"].includes(e)&&(c.title=r,c.description=o),["fb"].includes(e)&&(c.quote=r+" - "+o),Object(F.jsx)(U.a,{my:1,children:Object(F.jsx)(n,Object(I.a)(Object(I.a)({url:window.location.href},c),{},{children:Object(F.jsx)(a,{round:!0,size:Pe})}))},"share-".concat(t))})),Object(F.jsx)(he.a,{onClick:c,children:a?Object(F.jsx)(je.a,{}):Object(F.jsx)(pe.a,{})})]})},me={fb:{Btn:ce.a,Icon:re.a},rd:{Btn:oe.a,Icon:_e.a},tg:{Btn:ie.a,Icon:se.a},ws:{Btn:ue.a,Icon:le.a},wb:{Btn:be.a,Icon:de.a},tt:{Btn:Oe.a,Icon:fe.a}},Pe=32,xe=n(45),ye=n(78),ve="hkmanga",Me=function(){var e=Object(D.a)();Object(P.a)("play screen",e);var t=Object($.a)(),n=Object(y.g)().params,c=n.domain,r=n.storyPath.replace(new RegExp("--","g"),"/"),o="https://".concat(c,"/").concat(ve,"/stories/").concat(r,"/content.json"),i="last_scene-".concat(o),s=Object(Z.a)(i,""),u=Object(_.a)(s,2),l=u[0],b=void 0===l?"":l,d=u[1],O=Object(a.useState)(),f=Object(_.a)(O,2),h=f[0],j=f[1],p=Object(Q.a)(),E=Object(_.a)(p,2),g=E[0],m=E[1],x=Object(Q.a)(),M=Object(_.a)(x,2),C=M[0],S=M[1],T=Object(a.useState)(),B=Object(_.a)(T,2),k=B[0],A=B[1],R=Object(a.useState)(),L=Object(_.a)(R,2),w=L[0],U=L[1],z=Object(a.useState)(!1),N=Object(_.a)(z,2),q=N[0],ce=N[1],re=Object(a.useState)(!1),oe=Object(_.a)(re,2),_e=oe[0],ie=oe[1],se=Object(a.useState)(!1),ue=Object(_.a)(se,2),le=ue[0],be=ue[1],de=Object(a.useCallback)((function(e){return Object(P.b)(e,(function(e){return!1===Object(xe.a)(e)}),(function(e){return(w?w.mediaUrlRoot:"")+e}))}),[w]);Object(a.useEffect)((function(){if(Object(ye.b)()){var e=function(e){1!==e.scale&&e.preventDefault()};return window.document.addEventListener("touchmove",e,{passive:!1}),function(){return window.document.removeEventListener("touchmove",e)}}}),[]),Object(a.useEffect)((function(){if(!q&&h&&g.length){var e=g.filter((function(e){return"audio"===e.type}));if(e.length)e[0].url}}),[de,g,q,h]),Object(a.useEffect)((function(){h||e>1||H.a.get(o).then((function(e){return e.data})).then((function(e){return Object(P.a)("start scene: ",e.startScene),U(Object(I.a)({},e)),b||d(e.startScene||""),e.scenes})).then((function(e){S.set(e.filter((function(e){return Object(P.d)(e.url)&&Object(P.c)(J.f.map((function(t){return t===e.type})))})).map((function(e){var t="";switch(e.type){case"audio":t="audio";break;case"photoEffect":case"bgPhoto":case"photo":t="photo"}return{code:e.code,url:e.url,cat:t}}))),m.set(e),j(Object(te.d)(e))})).catch((function(e){console.warn(e),be(!0)}))}),[w,e,h,o,b,m,S,d]),Object(a.useEffect)((function(){h&&A(h.get(b))}),[A,h,b]);var Oe=Object(v.a)().t,fe=Object(a.useCallback)((function(){return w&&w.copyright&&Object(F.jsx)(ee.a,{absolute:!0,p:1,alignItems:"flex-end",children:Object(F.jsxs)(W.a,{style:{fontSize:10,textShadow:te.b},children:["\xa9 ",w.copyright]})})}),[w]),he=Object(a.useCallback)((function(){ce(!1),h&&(w&&w.startScene?b===w.startScene?A(h.get(b)):d(w.startScene):A(h.get(b)))}),[d,ce,w,A,h,b]),je=Object(a.useCallback)((function(){ce(!1),h&&A(h.get(b))}),[ce,A,h,b]);if(le)return Object(F.jsx)(K.a,{height:"100vh",children:Object(F.jsx)(W.a,{variant:"h5",children:Oe("Not Found")})});if(!w)return Object(F.jsx)("div",{children:"loading 0 ..."});if(!h)return Object(F.jsx)("div",{children:"loading 1 ..."});if(!k)return Object(F.jsx)("div",{children:"loading 2 ..."});if(!q){var pe=w.author,Ee=w.cover,me=w.title,Pe=w.description;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(V.a,{src:Ee}),Object(F.jsx)(ge,{title:me,description:Pe}),Object(F.jsxs)(ee.a,{bottom:t.spacing(4),children:[Object(F.jsx)(ee.a,{absolute:!0,bottom:140,children:Object(F.jsx)(X.a,{duration:1,children:Object(F.jsx)(W.a,{align:"center",style:{textShadow:te.b},variant:"h5",children:me})})}),Object(F.jsx)(ee.a,{absolute:!0,bottom:100,children:pe&&Object(F.jsx)(X.a,{duration:1,delay:200,children:Object(F.jsxs)(W.a,{style:{textShadow:te.b},variant:"body2",children:["by\xa0",pe.name]})})}),Object(F.jsx)(ee.a,{absolute:!0,bottom:20,children:Object(F.jsx)(X.a,{duration:1,delay:te.a,children:Object(F.jsxs)(G.a,{onClick:function(){ce(!0)},variant:"extended",color:"secondary",children:[Object(F.jsx)(Y.a,{}),"\xa0",Oe("start")]})})})]}),fe()]})}return _e?Object(F.jsxs)(ne,{dimensions:w.viewport,children:[Object(F.jsx)(te.c,{storyId:w.id,scenesMap:h,scene:k,onPlayNext:function(e){if(h){var t=h.get(e);return t&&t.entryPoint&&d(e),A(t),t}},onReachEnd:he,onExit:je}),fe()]}):Object(F.jsx)(K.a,{height:"100vh",children:Object(F.jsx)(ae.a,{mediaUrlRoot:w.mediaUrlRoot,onReady:function(){return ie(!0)},list:C})})},De=n(71),Ce=n.n(De),Se=n(98),Te=n(152),Ie=n(305),Be=n(291),ke=n(265),Ae=n(163),Re=n(225),Le=n(298),we=n(300),Ue=n(296),We=n(86),Ke=n(5),Fe=n(222),ze=n(230),Ne=n(287),qe=n(290),He=n(288),Ve=n(292),$e=n(294),Ge=n(289),Je=n(293),Xe=n(156),Ye=n(285),Ze=n(153),Qe=n.n(Ze),et=n(286),tt=n(284),nt=n(101),at=n(92),ct=function(e){return Object(F.jsx)(at.a,Object(I.a)(Object(I.a)({},e),{},{flexDirection:"row",children:e.children}))},rt=function(e){var t=Object(v.a)().t,n=e.onClick,c=e.showSelected,r=e.icon,o=e.options,i=e.onChange,s=e.defaultValue,u=Object(a.useState)(s),l=Object(_.a)(u,2),b=l[0],d=l[1],O=Object(a.useState)(function(){var e=o.filter((function(e){return e.v===b}));return e.length?e[0].k:""}()),f=Object(_.a)(O,2),h=f[0],j=f[1],p=Object(a.useState)(null),E=Object(_.a)(p,2),g=E[0],m=E[1],P=Boolean(g),x=function(e){m(e.currentTarget),n&&n()},y=function(){m(null)};return Object(F.jsxs)(U.a,{position:"relative",children:[e.children,c&&h?Object(F.jsx)(nt.a,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:x,children:Object(F.jsxs)(ct,{children:[Object(F.jsx)(tt.a,{}),"\xa0",Object(F.jsx)(W.a,{variant:"body1",children:t(h)})]})}):Object(F.jsx)(he.a,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:x,children:r||Object(F.jsx)(Qe.a,{})}),Object(F.jsx)(Xe.a,{anchorEl:g,keepMounted:!0,open:P,onClose:y,PaperProps:{style:{maxHeight:4.4*ot,minWidth:200}},children:o.map((function(e){return Object(F.jsxs)(Ye.a,{selected:void 0!==b&&e.v===b,onClick:(n=e.v,a=e.k,function(){j(a),d(n),i&&i(n,a),y()}),children:[e.icon?Object(F.jsx)(et.a,{children:e.icon}):"",Object(F.jsx)(Re.a,{primary:t(e.k)})]},e.k);var n,a}))})]})},ot=48,_t=function(e){var t=it(),n=e.avatar,c=e.collapsedContent,r=e.subheader,o=void 0===r?"":r,i=e.title,s=void 0===i?"":i,u=e.description,l=void 0===u?"":u,b=e.photo,d=void 0===b?"":b,O=e.menuContent,f=void 0===O?[]:O,h=e.menuChange,j=Object(a.useState)(!1),p=Object(_.a)(j,2),E=p[0],g=p[1];return Object(F.jsxs)(Ne.a,{className:t.root,children:[Object(F.jsx)(He.a,{avatar:n,action:Object(F.jsx)(rt,{onChange:h,icon:Object(F.jsx)(Ge.a,{}),options:f}),title:s,subheader:o}),d?Object(F.jsx)(qe.a,{className:t.media,image:d,title:s}):"",Object(F.jsx)(Be.a,{children:Object(F.jsx)(W.a,{variant:"body2",color:"textSecondary",component:"p",children:l})}),Object(F.jsxs)(Ve.a,{disableSpacing:!0,children:[e.children,Object(F.jsx)(he.a,{className:Object(Ke.a)(t.expand,Object(We.a)({},t.expandOpen,E)),onClick:function(){g(!E)},"aria-expanded":E,"aria-label":"show more",children:Object(F.jsx)(Je.a,{})})]}),Object(F.jsx)($e.a,{in:E,timeout:"auto",unmountOnExit:!0,children:c})]})},it=Object(Fe.a)((function(e){return Object(ze.a)({root:{width:"100%"},media:{height:256},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"}})})),st=n(295),ut=n(297),lt=function(e){var t=Object(v.a)().i18n;return Object(F.jsx)(st.a,{elevation:0,position:"fixed",children:Object(F.jsxs)(Ue.a,{disableGutters:!0,children:[Object(F.jsx)(he.a,{children:Object(F.jsx)("img",{alt:"logo",width:40,src:"https://play.hkman.ga/logo192.png"})}),e.children,Object(F.jsx)(U.a,{flexGrow:1}),Object(F.jsx)(rt,{showSelected:!0,icon:Object(F.jsx)(ut.a,{}),defaultValue:t.language,options:Object.entries(l).map((function(e){var t=Object(_.a)(e,2),n=t[0];return{k:t[1].text,v:n}})).reverse(),onChange:function(e){return t.changeLanguage(e)}}),Object(F.jsx)(U.a,{p:1})]})})},bt=n(299),dt=function(){var e=Object(y.f)(),t=Object(y.g)().params.domain,n="https://".concat(t,"/").concat(ve),c="".concat(n,"/index.txt"),r=Object(Q.a)(),o=Object(_.a)(r,2),i=o[0],s=o[1],u=Object(Q.a)(),l=Object(_.a)(u,2),b=l[0],d=l[1],O=Object(Ee.a)(!1),f=Object(_.a)(O,2),h=f[0],j=f[1];Object(P.a)(i),Object(P.a)(b);var p=Object(a.useCallback)((function(e){return"".concat(n,"/stories/").concat(e,"/content.json")}),[n]),E=Object(v.a)().t;Object(a.useEffect)((function(){i.length&&Object(Te.a)(Ce.a.mark((function e(){var t,n,a,c,r,o;return Ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=Object(Se.a)(i),e.prev=2,n.s();case 4:if((a=n.n()).done){e.next=16;break}return c=a.value,e.next=8,H.a.get(p(c));case 8:return r=e.sent,e.next=11,r.data;case 11:(o=e.sent).path=c,t.push(o);case 14:e.next=4;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),n.e(e.t0);case 21:return e.prev=21,n.f(),e.finish(21);case 24:d.set(t);case 25:case"end":return e.stop()}}),e,null,[[2,18,21,24]])})))()}),[i,d,p]),Object(a.useEffect)((function(){h||(j(!0),H.a.get(c).then((function(e){return e.data})).then((function(e){Object(P.a)(e);var t=[];Object(P.d)(e)&&(t=(t=e.split("\n")).filter((function(e){return"#"!==e[0]}))),s.set(t.filter(P.d))})))}),[c,s,h,j]);var g=Object(F.jsx)("div",{className:"masonry-wrapper",children:Object(F.jsx)("div",{className:"masonry",children:b.map((function(n,a){return Object(F.jsx)("div",{className:"masonry-item",children:Object(F.jsx)(_t,{avatar:function(){if(n.pegiRating){var e={3:"green",7:"yellow",12:"yellow",16:"orange",18:"red"}[+n.pegiRating];return Object(F.jsx)(Ie.a,{style:{backgroundColor:e,color:[7,12].includes(+n.pegiRating)?"black":"white"},"aria-label":"recipe",children:n.pegiRating})}}(),title:n.title,subheader:n.author?n.author.name:void 0,description:n.description,photo:n.cover,collapsedContent:Object(F.jsxs)(Be.a,{children:[function(){var e=n.author;return e?Object(F.jsxs)(ke.a,{disablePadding:!0,children:[Object(F.jsxs)(Ae.a,{disableGutters:!0,children:[Object(F.jsx)(Re.a,{primary:E("author"),secondary:e.name}),e.githubUserName&&Object(F.jsx)(Le.a,{children:Object(F.jsx)(he.a,{edge:"end",onClick:function(){return Object(xe.b)("https://github.com/"+e.githubUserName)},children:Object(F.jsx)(bt.a,{})})})]}),e.website&&Object(F.jsx)(Ae.a,{disableGutters:!0,children:Object(F.jsx)(Re.a,{primary:E("email"),secondary:e.email})}),e.website&&Object(F.jsxs)(Ae.a,{disableGutters:!0,children:[Object(F.jsx)(Re.a,{primary:E("website"),secondary:e.website}),Object(F.jsx)(Le.a,{children:Object(F.jsx)(he.a,{edge:"end",onClick:function(){(null===e||void 0===e?void 0:e.website)&&Object(xe.b)(null===e||void 0===e?void 0:e.website)},children:Object(F.jsx)(bt.a,{})})})]})]}):Object(F.jsx)(F.Fragment,{})}(),Object(F.jsx)(ke.a,{disablePadding:!0,children:["homePageUrl","termsAndConditionsUrl"].map((function(e){var t=n[e];return t?Object(F.jsxs)(Ae.a,{disableGutters:!0,children:[Object(F.jsx)(Re.a,{primary:E(e),secondary:t}),Object(F.jsx)(Le.a,{children:Object(F.jsx)(he.a,{edge:"end",onClick:function(){return Object(xe.b)(t)},children:Object(F.jsx)(bt.a,{})})})]},"story-field-".concat(e)):""}))}),Object(F.jsx)(ke.a,{disablePadding:!0,children:["license","copyright"].map((function(e){var t=n[e];return t?Object(F.jsx)(Ae.a,{disableGutters:!0,children:Object(F.jsx)(Re.a,{primary:E(e),secondary:t})},"story-field-".concat(e)):""}))})]}),children:Object(F.jsxs)(we.a,{onClick:function(){return e.push("/u/".concat(t,"/").concat(n.path.replace(/\//g,"--")))},children:[Object(F.jsx)(Y.a,{}),"\xa0",Object(F.jsx)(W.a,{children:E("Play")})]})})},"story-index-".concat(a))}))})});return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(lt,{children:Object(F.jsx)(W.a,{variant:"h5",children:"Play | HK Manga"})}),Object(F.jsx)(Ue.a,{}),g]})},Ot=c.a.createContext({}),ft=[(new R).theme,(new w).theme],ht=Object(M.a)()((function(){var e=Object(v.a)().i18n,t=Object(D.a)();Object.keys(l).includes(e.language)||e.changeLanguage("en"),Object(P.a)("\n    render count:\t{} times\n\n    locale:\t\t\t{}\n  ".att([t+"",e.language]));var n=ft[1],a=Object(C.a)(),c=Object(_.a)(a,2),r={state:c[0],setState:c[1]};return Object(F.jsx)(S.a,{theme:n,children:Object(F.jsx)(Ot.Provider,{value:r,children:Object(F.jsxs)(x.a,{children:[Object(F.jsx)(T.a,{}),Object(F.jsxs)(y.c,{children:[Object(F.jsx)(y.a,{exact:!0,path:"/u/:domain/:storyPath",component:Me}),Object(F.jsx)(y.a,{exact:!0,path:"/u/:domain",component:dt}),Object(F.jsx)(y.a,{exact:!0,path:"/",component:z}),Object(F.jsx)(y.a,{component:N})]})]})})})}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(F.jsx)(ht,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},27:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return BTN_DELAY})),__webpack_require__.d(__webpack_exports__,"b",(function(){return TEXT_SHADOW})),__webpack_require__.d(__webpack_exports__,"d",(function(){return makeScenesMap})),__webpack_require__.d(__webpack_exports__,"e",(function(){return pTrans}));var _Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9),_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(98),_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8),_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(18),howler__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(99),howler__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(howler__WEBPACK_IMPORTED_MODULE_4__),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__),lib_Scene__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(20),_FixedBox__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(17),_material_ui_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(80),_material_ui_icons__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(226),_material_ui_icons__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(227),lib_general__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(4),lib_string__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(97),react_use__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(119),react_use__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(114),react_use__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(120),react_use__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(115),react_use__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(164),_ScenePhotoComponent__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(146),_SmallButton__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(111),react_i18next__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(105),_SceneBgPhotoComponent__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(147),_Background__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(96),_SceneTextComponent__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(148),lib_SceneText__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(149),lib_SceneBgPhoto__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(112),lib_ScenePhoto__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(63),lib_SceneEffect__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(150),_ContentLoader__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(54),lib_utils__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(113),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(2),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30___default=__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__),storyState={},SceneComponent=function SceneComponent(props){Object(react_use__WEBPACK_IMPORTED_MODULE_13__.a)((function(){stopAudio(),audioPlayer.clear(),null===audioMap||void 0===audioMap||audioMap.clear(),lastSceneId=""}));var _useTranslation=Object(react_i18next__WEBPACK_IMPORTED_MODULE_20__.a)(),t=_useTranslation.t,rerender=Object(react_use__WEBPACK_IMPORTED_MODULE_14__.a)(),nRenders=Object(react_use__WEBPACK_IMPORTED_MODULE_15__.a)();Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("scene component",nRenders);var storyId=props.storyId,scenesMap=props.scenesMap,scene=props.scene,onPlayNext=props.onPlayNext,onReachEnd=props.onReachEnd,onExit=props.onExit;Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("id: ",scene.id);var firstChoice=Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.b)(scene.choices,(function(e){return void 0!==e}),(function(e){return e[0]})),lastChoice=Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.b)(scene.choices,(function(e){return void 0!==e}),(function(e){return Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__.a)(e).pop()})),storyStateKey="____state-".concat(storyId);storyState=Object(lib_utils__WEBPACK_IMPORTED_MODULE_29__.a)(storyStateKey);var _useState=Object(react__WEBPACK_IMPORTED_MODULE_5__.useState)(""),_useState2=Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_useState,2),nextSceneId=_useState2[0],setNextSceneId=_useState2[1],onPlayNextScene=Object(react__WEBPACK_IMPORTED_MODULE_5__.useCallback)((function(e){Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(e)&&(onPlayNext&&onPlayNext(e),scene.skipAfter||setNextSceneId(e))}),[setNextSceneId,onPlayNext,scene.skipAfter]),saveStoryState=Object(react__WEBPACK_IMPORTED_MODULE_5__.useCallback)((function(){Object(lib_utils__WEBPACK_IMPORTED_MODULE_29__.a)(storyStateKey,storyState),rerender()}),[storyStateKey,rerender]),_useToggle=Object(react_use__WEBPACK_IMPORTED_MODULE_16__.a)(!1),_useToggle2=Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_useToggle,2),mute=_useToggle2[0],toggleMute=_useToggle2[1],_useState3=Object(react__WEBPACK_IMPORTED_MODULE_5__.useState)("#000"),_useState4=Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_useState3,2),bgColour=_useState4[0],setBgColour=_useState4[1],_useState5=Object(react__WEBPACK_IMPORTED_MODULE_5__.useState)(),_useState6=Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_useState5,2),sceneBgPhoto=_useState6[0],_setSceneBgPhoto=_useState6[1],setSceneBgPhoto=Object(react__WEBPACK_IMPORTED_MODULE_5__.useCallback)((function(e){_setSceneBgPhoto(void 0),setTimeout((function(){_setSceneBgPhoto(e)}),10)}),[_setSceneBgPhoto]),_useState7=Object(react__WEBPACK_IMPORTED_MODULE_5__.useState)(),_useState8=Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_useState7,2),sceneText=_useState8[0],_setSceneText=_useState8[1],setSceneText=Object(react__WEBPACK_IMPORTED_MODULE_5__.useCallback)((function(e){_setSceneText(void 0),clearTimeout(timer),timer=setTimeout((function(){_setSceneText(e)}),10)}),[_setSceneText]),_useList=Object(react_use__WEBPACK_IMPORTED_MODULE_17__.a)(),_useList2=Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_useList,2),choiceList=_useList2[0],choiceStack=_useList2[1],_useList3=Object(react_use__WEBPACK_IMPORTED_MODULE_17__.a)(),_useList4=Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_useList3,2),scenePhotos=_useList4[0],scenePhotoStack=_useList4[1],stopAudio=Object(react__WEBPACK_IMPORTED_MODULE_5__.useCallback)((function(e){if(e){var t=audioPlayer.get(e);t&&(t.stop(),audioPlayer.delete(e),audioProps.delete(e))}else audioPlayer.forEach((function(e){return e.stop()}))}),[]),getEffect=Object(react__WEBPACK_IMPORTED_MODULE_5__.useCallback)((function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;if(!scenesMap)return[];var a=Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__.a)(n);Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("get effect: ",t);var c=scenesMap.get(t);if(Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("scene: ",c),!c)return a;a=[].concat(Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__.a)(a),[c]),Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("get scene: ",c);var r=null===(e=c.choices[0])||void 0===e?void 0:e.toScene;return Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("next scene: ",r),r?getEffect(r,a):a}),[scenesMap]);Object(react__WEBPACK_IMPORTED_MODULE_5__.useEffect)((function(){if(scene.skipAfter&&firstChoice){var e=setTimeout((function(){onPlayNextScene(firstChoice.toScene)}),1e3*+scene.skipAfter);return function(){clearTimeout(e)}}}),[scene,onPlayNextScene,scenePhotos,firstChoice]),Object(react__WEBPACK_IMPORTED_MODULE_5__.useEffect)((function(){"text"===scene.type&&(lastSceneId=scene.id,setSceneText(new lib_SceneText__WEBPACK_IMPORTED_MODULE_24__.a(scene)))}),[scene,setSceneText]),Object(react__WEBPACK_IMPORTED_MODULE_5__.useEffect)((function(){if("update"===scene.type&&firstChoice&&storyState&&nRenders%2!==0){var effect=new lib_SceneEffect__WEBPACK_IMPORTED_MODULE_27__.a(scene).props.effect;if(effect){var key=effect.key,adjust=effect.adjust,assign=effect.assign,textValue=effect.textValue;if(Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(key)){key=pTrans(key),storyState[key]=+(storyState[key]||0),Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("key",key),Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("storyState",storyState),Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("text",textValue),Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("assign",assign),Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("adjust",adjust);try{if(Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(textValue))storyState[key]=pTrans(textValue);else{if(Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(assign)){var v=assign.toString();v="_RAND"===v?Math.random().toString():pTrans(v),storyState[key]=Number(eval(v))}if(Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(adjust)){var _v=pTrans(adjust.toString());storyState[key]=+storyState[key]+Number(eval(_v))}}saveStoryState()}catch(e){console.warn(e)}onPlayNextScene(firstChoice.toScene)}}}}),[scene,nRenders,onPlayNextScene,storyStateKey,saveStoryState,firstChoice]),Object(react__WEBPACK_IMPORTED_MODULE_5__.useEffect)((function(){if("evaluate"===scene.type&&nRenders%2!==0){var list=scene.list,key=scene.key;if(key&&list){var stateTextValue=storyState[key]||"",stateNumericValue=+(stateTextValue||0),_iterator=Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_1__.a)(list),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var c=_step.value,vmin=void 0,vmax=void 0;if(Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(c.vMin)&&(vmin=+eval(pTrans(c.vMin.toString()))),Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(c.vMax)&&(vmax=+eval(pTrans(c.vMax.toString()))),!Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(vmin)&&!Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(vmax)&&!Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(c.vText)&&!Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(stateTextValue))return void onPlayNextScene(c.toScene);try{if(Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(vmin)&&Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(vmax)){if(stateNumericValue>=vmin&&stateNumericValue<vmax)return void onPlayNextScene(c.toScene)}else{if(Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(vmin)&&stateNumericValue>=vmin)return void onPlayNextScene(c.toScene);if(Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(vmax)&&stateNumericValue<=vmax)return void onPlayNextScene(c.toScene)}}catch(e){console.warn(e)}if(Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(c.vText)&&(c.vText===stateTextValue||c.vText===lib_Scene__WEBPACK_IMPORTED_MODULE_6__.a))return void onPlayNextScene(c.toScene)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}}}),[scene,onPlayNextScene,nRenders]),Object(react__WEBPACK_IMPORTED_MODULE_5__.useEffect)((function(){var e,t;if(scenesMap&&"bgPhoto"===scene.type)if(lastSceneId!==scene.id){if(lastSceneId=scene.id,new lib_SceneBgPhoto__WEBPACK_IMPORTED_MODULE_25__.a(scene).props.url){var n=new lib_SceneBgPhoto__WEBPACK_IMPORTED_MODULE_25__.a(scene);n.setProps({effects:getEffect(null===(e=scene.choices[1])||void 0===e?void 0:e.toScene,[]),afterEffects:getEffect(null===(t=scene.choices[2])||void 0===t?void 0:t.toScene,[])}),setSceneBgPhoto(n)}}else lastSceneId=""}),[scene,setSceneBgPhoto,getEffect,scenesMap]),Object(react__WEBPACK_IMPORTED_MODULE_5__.useEffect)((function(){if(scenesMap&&"photo"===scene.type)if(lastSceneId!==scene.id){lastSceneId=scene.id;var code=scene.code,paramType=scene.paramType,paramName=scene.paramName,paramValue=scene.paramValue,url=scene.url;if(url||code){var data=new lib_ScenePhoto__WEBPACK_IMPORTED_MODULE_26__.a(Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.a)(Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.a)({},scene),{},{code:pTrans(scene.code)})).props,_scene$choices$3,_scene$choices$4;if(scene.choices.length>=3)data.effects=getEffect(null===(_scene$choices$3=scene.choices[1])||void 0===_scene$choices$3?void 0:_scene$choices$3.toScene,[]),data.afterEffects=getEffect(null===(_scene$choices$4=scene.choices[2])||void 0===_scene$choices$4?void 0:_scene$choices$4.toScene,[]);return data.onClick=function(){if(data.afterEffects){var delay=0;data.afterEffects.forEach((function(e){delay+=(e.delay||0)+(e.duration||0)})),timer=setTimeout((function(){lastChoice&&onPlayNextScene(lastChoice.toScene)}),1e3*(delay+1))}if(storyState&&Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(paramName)&&Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(paramValue)){var k=paramName.toString(),v=paramValue.toString();"textValue"===paramType&&(storyState[k]=pTrans(v)),"assign"===paramType&&(storyState[k]=Number(eval(pTrans(v)))),"adjust"===paramType&&(storyState[k]=Number(storyState[k])+Number(eval(pTrans(v)))),saveStoryState()}},scenePhotoStack.update((function(e){return!e.props.persist}),new lib_ScenePhoto__WEBPACK_IMPORTED_MODULE_26__.a({hidden:!0})),scenePhotoStack.push(new lib_ScenePhoto__WEBPACK_IMPORTED_MODULE_26__.a(data)),function(){clearTimeout(timer)}}}else lastSceneId=""}),[getEffect,scenesMap,saveStoryState,onPlayNextScene,scene,scenePhotoStack,lastChoice]);var _useAudios=Object(_ContentLoader__WEBPACK_IMPORTED_MODULE_28__.b)(),_useAudios2=Object(_Users_honzungchang_Projects_git_github_com_changhz_storysberg_play_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_useAudios,1),audioMap=_useAudios2[0];Object(react__WEBPACK_IMPORTED_MODULE_5__.useEffect)((function(){audioPlayer.forEach((function(e){return e.volume(mute?0:1)}))}),[mute]),Object(react__WEBPACK_IMPORTED_MODULE_5__.useEffect)((function(){if("audio"===scene.type)if(lastSceneId!==scene.id){lastSceneId=scene.id;var e=scene.code,n=scene.url,a=scene.repeat,c=scene.volume,r=void 0===c?100:c,o=pTrans(n);if(e&&(o=e),o&&audioMap){var _=audioMap.get(o);if(Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("audio src",_),_){var i=audioPlayer.get(o);if(i)return i.volume(r/100),void(i.playing()||i.play());audioPlayer.set(o,new howler__WEBPACK_IMPORTED_MODULE_4__.Howl({src:_,autoplay:!0,loop:a,volume:r/100,onend:function(){Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("first choice",firstChoice),Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)("skip after",scene.skipAfter),firstChoice&&(scene.skipAfter||onPlayNextScene(firstChoice.toScene))},onloaderror:function(e,n){console.warn(n),alert(t("Cannot load audio ")+_)},onplayerror:function(e){console.warn(e),alert(t("Cannot play audio ")+_)}}))}}}else lastSceneId=""}),[scene,audioMap,firstChoice,t,onPlayNextScene]),Object(react__WEBPACK_IMPORTED_MODULE_5__.useEffect)((function(){if("regulate"===scene.type&&firstChoice){lastSceneId=scene.id,scene.stopAudio&&stopAudio(pTrans(scene.audioCode)),scene.clearText&&setSceneText(void 0),scene.clearBgPhoto&&setSceneBgPhoto(void 0),scene.clearPhoto&&(scene.photoCode?scenePhotoStack.update((function(e){return e.props.code===pTrans(scene.photoCode)}),new lib_ScenePhoto__WEBPACK_IMPORTED_MODULE_26__.a({hidden:!0})):scenePhotoStack.clear());var e=setTimeout((function(){onPlayNextScene(firstChoice.toScene)}),10);return function(){clearTimeout(e)}}}),[firstChoice,onPlayNextScene,scene,scenePhotoStack,setSceneBgPhoto,setSceneText,stopAudio]),Object(react__WEBPACK_IMPORTED_MODULE_5__.useEffect)((function(){scene&&(scene.bgColour&&setBgColour(scene.bgColour),choiceStack.set(scene.choices||[]))}),[scene,choiceStack]);var handleChoiceClick=Object(react__WEBPACK_IMPORTED_MODULE_5__.useCallback)((function(e){audioProps.forEach((function(e){var t;e.persist||e.code&&(null===(t=audioPlayer.get(e.code))||void 0===t||t.stop(),audioPlayer.delete(e.code))})),e&&Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(e.toScene)?onPlayNextScene(e.toScene):onReachEnd&&onReachEnd()}),[onPlayNextScene,onReachEnd]),textBlock=sceneText?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsx)(_SceneTextComponent__WEBPACK_IMPORTED_MODULE_23__.a,{storyState:storyState,disableChoice:!!scene.skipAfter,sceneText:sceneText,choiceList:sceneText.props.id===scene.id?choiceList:[],handleChoiceClick:handleChoiceClick,onInputChange:function(e){if(sceneText){var t=sceneText.props.inputKey;t&&(storyState[t]=e.target.value,Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)(t+" = "+e.target.value),clearTimeout(timer),timer=setTimeout((function(){saveStoryState()}),400))}}}):"",scenePhotoObjs=[];scenePhotos.forEach((function(e,t){if(!e.props.hidden){var n=scenePhotoObjs.findIndex((function(t){return t&&t.props.code===e.props.code}));n>-1&&n<t?scenePhotoObjs[n]=e:scenePhotoObjs[t]=e}}));var body=Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsx)(_FixedBox__WEBPACK_IMPORTED_MODULE_7__.a,{absolute:!0,bottom:"auto",zIndex:3,top:0,left:"auto",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_8__.a,{p:2,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsx)(_SmallButton__WEBPACK_IMPORTED_MODULE_19__.a,{onClick:function(){window.confirm(t("Exiting story. Continue?"))&&onExit&&onExit()},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsx)(_material_ui_icons__WEBPACK_IMPORTED_MODULE_9__.a,{style:{fill:"#eee"}})})})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsx)(_FixedBox__WEBPACK_IMPORTED_MODULE_7__.a,{absolute:!0,bottom:"auto",zIndex:3,top:0,right:"auto",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_8__.a,{p:2,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsx)(_SmallButton__WEBPACK_IMPORTED_MODULE_19__.a,{onClick:toggleMute,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsx)(_material_ui_icons__WEBPACK_IMPORTED_MODULE_10__.a,{style:{fill:mute?"#ccc":"#888"}})})})}),scenePhotoObjs.map((function(e,t){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsx)(_ScenePhotoComponent__WEBPACK_IMPORTED_MODULE_18__.a,{scenePhoto:e},"photo-".concat(t))})),textBlock]});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.Fragment,{children:[bgColour&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsx)(_Background__WEBPACK_IMPORTED_MODULE_22__.a,{zIndex:-2,absolute:!0,bgColour:bgColour}),sceneBgPhoto&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_30__.jsx)(_SceneBgPhotoComponent__WEBPACK_IMPORTED_MODULE_21__.a,{absolute:!0,nextSceneId:nextSceneId,sceneBgPhoto:sceneBgPhoto}),"update"!==scene.type&&"evaluate"!==scene.type&&body]})},timer;__webpack_exports__.c=SceneComponent;var audioPlayer=new Map,audioProps=new Map,BTN_DELAY=800,TEXT_SHADOW="0 0 10px #000",makeScenesMap=function(e){var t=new Map;return e.forEach((function(e){return t.set(e.id,e)})),t},lastSceneId="",pTrans=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t.toString();return Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.c)(["{","}"],(function(e){return!n.includes(e)}))?n:(Object(lib_string__WEBPACK_IMPORTED_MODULE_12__.b)("{}",t).forEach((function(e){var t=storyState[e];Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.a)(e+": "+t),n=n.replace("{".concat(e,"}"),Object(lib_general__WEBPACK_IMPORTED_MODULE_11__.d)(t)?t:0)})),e(n))}},35:function(e,t,n){"use strict";var a=n(9),c=(n(0),n(92)),r=n(2);t.a=function(e){return Object(r.jsx)(c.a,Object(a.a)({alignItems:"center",justifyContent:"center"},e))}},4:function(e,t,n){"use strict";n.d(t,"g",(function(){return a})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return _})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return b}));n(71),n(8),n(142),n(157),Math.random,Math.ceil,Math.floor,Math.tanh;var a=/"(-?\d+(.\d+)?)"/g,c=/ ?0+(?=[1-9.])/g,r=function(){},o=function(e){var t={};return Object.keys(e).forEach((function(n){s(e[n])&&(t[n]=e[n])})),t},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.6,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"rgba(".concat(t,",").concat(t,",").concat(t,",").concat(e,")")},i=function(e){return/(?=.*?\d)^-?(([1-9]\d{0,2}(,\d{3})*)|\d+)?(\.\d+)?$/.test(e)},s=function(e){return null!==e&&void 0!==e&&""!==e.toString()},u=function(e,t,n){return!0===t(e)?n(e):e},l=function(e,t){return function(e,t){return 0===e.length?t:e}(e.map((function(e){return"boolean"===typeof e?e:void 0!==t&&t(e)})),[!1,!1])},b=function(e,t){return l(e,t).reduce((function(e,t){return e||t}))}},45:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var a=function(e){return new RegExp("^(http|https)://").test(e)},c=function(e){var t=window.open(e,"_blank");null===t||void 0===t||t.focus()}},54:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return E}));var a=n(18),c=n(8),r=n(0),o=n(222),_=n(230),i=n(304),s=n(119),u=n(99),l=n(4),b=n(45),d=n(105),O=n(17),f=n(264),h=n(2),j=function(){return Object(h.jsx)(O.a,{absolute:!0,top:0,children:Object(h.jsx)(f.a,{})})},p=Object(i.a)(new Map),E=Object(i.a)(new Map),g=(t.a=function(e){Object(s.a)((function(){y.forEach((function(e){return clearTimeout(e)}))}));var t=e.onReady,n=e.list,o=e.mediaUrlRoot,_=void 0===o?"":o,i=Object(r.useState)(0),O=Object(c.a)(i,2),f=O[0],v=O[1],M=Object(d.a)().t,D=m*f,C=g(),S=Object(r.useCallback)((function(e){return Object(l.b)(e,(function(e){return!1===Object(b.a)(e)}),(function(e){return _+e}))}),[_]),T=p(),I=Object(c.a)(T,2)[1],B=E(),k=Object(c.a)(B,2)[1],A=Object(r.useCallback)((function(e){var a=e.pop();if(Object(l.a)("processing"),Object(l.a)(a),!a)return I(x),k(P),v(1),void y.push(setTimeout((function(){t&&t()}),1e3));var c=a.code,r=a.url,o=a.cat;if(r){if(Object(l.c)(["{","}"],(function(e){return r.includes(e)})))return Object(l.a)("will skip ".concat(r)),void A(e);var _=c||r;if(P.has(_)||x.has(_))A(e);else{v(1-(e.length+1)/n.length);var i=S(r);switch(o){case"audio":P.set(_,i),new u.Howl({src:i,autoplay:!1,onloaderror:function(e,t){console.warn(t),alert(M("Cannot load audio ")+i)},onload:function(){A(e)}});break;case"photo":var s=new Headers;fetch(i,{cache:"default",method:"GET",headers:s}).then((function(t){t.arrayBuffer().then((function(t){var n=function(e){var t="";return[].slice.call(new Uint8Array(e)).forEach((function(e){return t+=String.fromCharCode(e)})),window.btoa(t)}(t);x.set(_,"data:image/jpeg;base64,"+n),A(e)}))})).catch((function(e){console.warn(e),alert(M("Cannot load photo ")+i)}));break;default:A(e)}}}else A(e)}),[I,k,v,n.length,S,t,M]);return Object(r.useEffect)((function(){P.clear(),x.clear(),A(Object(a.a)(n))}),[n,A]),Object(h.jsxs)("div",{children:[Object(h.jsx)(j,{}),Object(h.jsx)("div",{className:C.root,children:Object(h.jsx)("div",{className:C.bar,style:{width:D}})})]})},Object(o.a)((function(){return Object(_.a)({root:{overflow:"hidden",borderRadius:4,position:"relative",width:m,height:10,border:"1px solid #444",backgroundColor:"#eee",top:100,right:0,bottom:0,left:0},bar:{backgroundColor:"#faa",transition:"all .9s ease-in-out",position:"absolute",top:0,bottom:0,left:0}})}))),m=200,P=new Map,x=new Map,y=[]},57:function(e,t,n){"use strict";var a=n(9),c=n(8),r=n(0),o=n(80),_=n(97),i=function(e){var t=e.type,n=void 0===t?"in":t,c=e.from,r=e.fade,o=e.disp,i=e.duration,s=void 0===i?0:i,u="out"===n?1-r:r,l=Object(a.a)({opacity:u},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{display:e?"inherit":"none",transition:t>0?"all ".concat(t,"s ease-in-out"):"none"}}(o,s));return c&&(l["margin".concat(Object(_.a)(c))]=-400*(1-u)),l},s=n(2);t.a=function(e){var t=Object(r.useState)(!1),n=Object(c.a)(t,2),_=n[0],u=n[1],l=Object(r.useState)(0),b=Object(c.a)(l,2),d=b[0],O=b[1],f=e.type,h=void 0===f?"in":f,j=e.from,p=e.value,E=e.delay,g=void 0===E?0:E,m=e.duration,P=void 0===m?0:m;return Object(r.useEffect)((function(){if(_){var e=setTimeout((function(){O(void 0===p?1:p)}),100);return function(){clearTimeout(e)}}}),[p,_]),Object(r.useEffect)((function(){var e=setTimeout((function(){u(!0)}),g);return function(){clearTimeout(e)}}),[g]),_?Object(s.jsx)(o.a,Object(a.a)(Object(a.a)({className:e.className,style:i({disp:!0,from:j,fade:d,duration:P,type:h})},e.box),{},{children:e.children})):Object(s.jsx)(s.Fragment,{})}},63:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u}));var a=n(15),c=n(25),r=n(24),o=n(18),_=n(20),i=["url"].concat(Object(o.a)(_.b),["filter","transform","timingFunction","opacity","zIndex"],Object(o.a)(_.e),Object(o.a)(_.d)),s=["repeatEffects"].concat(Object(o.a)(i)),u=(["persist"].concat(Object(o.a)(s),["paramType","paramName","paramValue"]),function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return n}(_.c))},70:function(e,t,n){"use strict";var a=n(9),c=n(8),r=n(102),o=n(0),_=n(2);t.a=function(e){var t=e.src,n=e.onReady,i=Object(r.a)(e,["src","onReady"]),s=Object(o.useState)(!1),u=Object(c.a)(s,2),l=u[0],b=u[1],d=Object(o.useRef)(),O=Object(o.useCallback)((function(){b(!0),n&&n()}),[b,n]);return Object(o.useEffect)((function(){var e=d.current;if(e&&t)return e.setAttribute("src",t),e.addEventListener("load",O),function(){e&&e.removeEventListener("load",O)}}),[t,O]),l?Object(_.jsx)("img",Object(a.a)({alt:""},i)):Object(_.jsx)("img",{style:{visibility:"hidden"},ref:function(e){e&&(d.current=e,d.current.draggable=!1)},alt:""})}},78:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var a=function(e,t){return void 0===t?window.localStorage.getItem(e):window.localStorage.setItem(e,t.toString())},c=function(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}},85:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(9),c=n(15),r=n(68),o=function(){function e(t){Object(c.a)(this,e),this.props=void 0,this.state={},this.props=t}return Object(r.a)(e,[{key:"setProps",value:function(e){this.props=Object(a.a)(Object(a.a)({},this.props),e)}},{key:"setState",value:function(e){this.state=Object(a.a)(Object(a.a)({},this.state),e)}}]),e}()},92:function(e,t,n){"use strict";var a=n(9),c=(n(0),n(80)),r=n(2);t.a=function(e){return Object(r.jsx)(c.a,Object(a.a)(Object(a.a)({},e),{},{display:"flex",children:e.children}))}},96:function(e,t,n){"use strict";var a=n(0),c=n(222),r=n(230),o=n(70),_=n(2),i=Object(a.forwardRef)((function(e,t){var n=e.zIndex,a=void 0===n?0:n,c=e.absolute,r=void 0!==c&&c,i=e.bgColour,u=e.src,l=s();return Object(_.jsxs)("div",{style:{zIndex:a,position:r?"absolute":"fixed",backgroundColor:i},className:l.root,ref:t,children:[u&&Object(_.jsx)(o.a,{src:u,onReady:function(){},style:{display:"block",alignSelf:"center"}}),e.children]})}));t.a=i;var s=Object(c.a)((function(){return Object(r.a)({photo:{},root:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",top:0,right:0,bottom:0,left:0,zIndex:-1}})}))},97:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return r}));var a=n(8),c=function(e,t){var n,c=e.split(""),r=Object(a.a)(c,2),o=r[0],_=r[1],i=[],s=new RegExp("".concat(o,"([^").concat(_,"^").concat(o,"]+)").concat(_),"g");do{(n=s.exec(t))&&i.push(n[1])}while(n);return i},r=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}},[[220,1,2]]]);